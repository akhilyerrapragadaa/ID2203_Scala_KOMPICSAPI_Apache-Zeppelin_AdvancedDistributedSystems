{"paragraphs":[{"text":"%md\n\n### From Best Effort to Causal Order Reliable Broadcast\n\nThis is the first programming assignment where you will have to build and reuse multiple components. \nStarting bottom-up, you will first have to implement *best effort broadcast*, then *reliable broadcast* and finally *causal order reliable broadcast*.\nMind that passing each component check will give you a **partial** grade and therefore you will need to pass **all** checks to get the full grade for this programming assignment.\n\n**Things to Remember**:\n1. Some components such as `PerfectLink`,  `Network` and `Timer` are already provided. No need to implement them.\n2. Execute the imports defined below **before** compiling your component implementations.\n3. We recommend making use of the component state and internal messages we have provided, if any, to complete the implementation logic.\n4. You can always print messages to the output log, from within handlers to see what happens during the simulation. e.g. `println(s\"Process $self delivers message $msg\");`\n5. Remember that during the simulation check you can print and observe the simulation time, i.e. with `System.currentTimeMillis()`.\n5. Do not forget to run the checker code block after each component implementation to ensure that all properties are satisfied before exporting and submitting the notebook.\n6. You can always restart the Kompics Interpreter to start fresh (Interpreter→KompicsInterpreter→Click Restart)\n7. Do **not** submit just the grading token to edx. You will have to submit the whole exported notebook content to get your grade.\n\nGood luck! :)","dateUpdated":"2020-02-09T19:18:45+0000","config":{"editorSetting":{},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>From Best Effort to Causal Order Reliable Broadcast</h3>\n<p>This is the first programming assignment where you will have to build and reuse multiple components.<br/>Starting bottom-up, you will first have to implement <em>best effort broadcast</em>, then <em>reliable broadcast</em> and finally <em>causal order reliable broadcast</em>.<br/>Mind that passing each component check will give you a <strong>partial</strong> grade and therefore you will need to pass <strong>all</strong> checks to get the full grade for this programming assignment.</p>\n<p><strong>Things to Remember</strong>:<br/>1. Some components such as <code>PerfectLink</code>, <code>Network</code> and <code>Timer</code> are already provided. No need to implement them.<br/>2. Execute the imports defined below <strong>before</strong> compiling your component implementations.<br/>3. We recommend making use of the component state and internal messages we have provided, if any, to complete the implementation logic.<br/>4. You can always print messages to the output log, from within handlers to see what happens during the simulation. e.g. <code>println(s&quot;Process $self delivers message $msg&quot;);</code><br/>5. Remember that during the simulation check you can print and observe the simulation time, i.e. with <code>System.currentTimeMillis()</code>.<br/>5. Do not forget to run the checker code block after each component implementation to ensure that all properties are satisfied before exporting and submitting the notebook.<br/>6. You can always restart the Kompics Interpreter to start fresh (Interpreter→KompicsInterpreter→Click Restart)<br/>7. Do <strong>not</strong> submit just the grading token to edx. You will have to submit the whole exported notebook content to get your grade.</p>\n<p>Good luck! :)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1581275925429_147833926","id":"20160915-144724_1712226433","dateCreated":"2020-02-09T19:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:307"},{"text":"import se.kth.edx.id2203.core.ExercisePrimitives._\nimport se.kth.edx.id2203.core.Ports._\nimport se.kth.edx.id2203.validation._\nimport se.sics.kompics.network._\nimport se.sics.kompics.sl.{Init, _}\nimport se.sics.kompics.{ComponentDefinition => _, Port => _, KompicsEvent}\n\nimport scala.collection.immutable.Set\nimport scala.collection.mutable.ListBuffer\nimport scala.collection.mutable.Buffer","user":"anonymous","dateUpdated":"2020-02-10T16:39:50+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"import se.kth.edx.id2203.core.ExercisePrimitives._<br />import se.kth.edx.id2203.core.Ports._<br />import se.kth.edx.id2203.validation._<br />import se.sics.kompics.network._<br />import se.sics.kompics.sl.{Init, _}<br />import se.sics.kompics.{ComponentDefinition=>_, Port=>_, KompicsEvent}<br />import scala.collection.immutable.Set<br />import scala.collection.mutable.ListBuffer<br />import scala.collection.mutable.Buffer<br />"}]},"apps":[],"jobName":"paragraph_1581275925432_146679679","id":"20160728-150612_1687562708","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T16:39:50+0000","dateFinished":"2020-02-10T16:40:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308"},{"text":"%md\n\n### Part I: Best-Effort Broadcast ###\n\nA Best-Effort Broadcast Abstraction (BEB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class BestEffortBroadcast extends Port {\n     indication[BEB_Deliver];\n     request[BEB_Broadcast];\n    }\n\nA **BEB** component should request `BEB_Broadcast` and indicate `BEB_Deliver` events as defined below:\n\n     case class BEB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n     case class BEB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n\n\nAs you have already learnt from the course lectures, Best-Effort Broadcast should satisfy the following properties:\n\n1. **Validity**:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. **No duplication**: *No message is delivered more than once.*\n3. **No creation**: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n\nHINT: The recommended algorithm to use in this assignment is *Basic Broadcast* and is described in the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/a91e7d1ac75367325c1efd101a9e2138/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/basicbroadcast.pdf) in the respective lecture.\n","dateUpdated":"2020-02-09T19:18:45+0000","config":{"editorSetting":{},"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Part I: Best-Effort Broadcast</h3>\n<p>A Best-Effort Broadcast Abstraction (BEB), in Kompics terms, is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class BestEffortBroadcast extends Port {\n indication[BEB_Deliver];\n request[BEB_Broadcast];\n}\n</code></pre>\n<p>A <strong>BEB</strong> component should request <code>BEB_Broadcast</code> and indicate <code>BEB_Deliver</code> events as defined below:</p>\n<pre><code> case class BEB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n case class BEB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Best-Effort Broadcast should satisfy the following properties:</p>\n<ol>\n  <li><strong>Validity</strong>: <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n  <li><strong>No duplication</strong>: <em>No message is delivered more than once.</em></li>\n  <li><strong>No creation</strong>: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Basic Broadcast</em> and is described in the following <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/a91e7d1ac75367325c1efd101a9e2138/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/basicbroadcast.pdf\">document</a> in the respective lecture.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1581275925435_147064428","id":"20160915-145354_1020037731","dateCreated":"2020-02-09T19:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"text":"\nclass BasicBroadcast(init: Init[BasicBroadcast]) extends ComponentDefinition {\n\n  //BasicBroadcast Subscriptions\n  val pLink = requires[PerfectLink];\n  val beb = provides[BestEffortBroadcast];\n  var i=0\n  var delivered = 0\n  \n  \n  //BasicBroadcast Component State and Initialization\n  val (self, topology) = init match {\n    case Init(s: Address, t: Set[Address]@unchecked) => (s, t)\n  };\n  \n  \n  //BasicBroadcast Event Handlers\n  beb uponEvent {\n    case x@BEB_Broadcast(payload) => {\n     /* WRITE YOUR CODE HERE  */\n     \n     for (p <- topology){\n      trigger(PL_Send(p, payload) -> pLink);  \n     }\n     \n    }\n  }\n\n  pLink uponEvent {\n    case PL_Deliver(src,payload) => {\n         trigger(BEB_Deliver(src,payload) -> beb)\n         \n    }\n  }\n}","user":"anonymous","dateUpdated":"2020-02-10T16:39:53+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"defined class BasicBroadcast<br />"}]},"apps":[],"jobName":"paragraph_1581275925436_145140684","id":"20160728-150736_1548510044","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T16:39:58+0000","dateFinished":"2020-02-10T16:40:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310"},{"text":"checkBEB[BasicBroadcast]();","user":"anonymous","dateUpdated":"2020-02-10T16:06:16+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<br />Your submission has been locally simulated and validated.<br /><br /><a href=\"\\static\\log.txt\" target=\"_blank\">Click Here</a> to view the output of the simulation.<br /><style type=\"text/css\">.tg  {border-collapse:collapse;border-spacing:0;border-color:#aabcfe;}.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#669;background-color:#e8edff;}.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#039;background-color:#b9c9fe;}.tg .tg-mb3i{background-color:#D2E4FC;text-align:right;vertical-align:top}.tg .tg-lqy6{text-align:right;vertical-align:top}.tg .tg-vlnx{background-color:#3071a9;color:#ffffff;text-align:center;vertical-align:top}.tg .tg-6k2t{background-color:#D2E4FC;vertical-align:top}.tg tg-6k2l{background-color:#ffb3b3;vertical-align:top}.tg .tg-yw4l{vertical-align:top}</style><table class=\"tg\">  <tr>    <th class=\"tg-vlnx\" colspan=\"3\">Correction Results</th>  </tr><br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">Validity</td> <td class=\"tg-6k2t\">✔:  Eventually every correct process delivers every message broadcasted by correct processes<br></td>  </tr>  <br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">No Duplication-No Creation</td> <td class=\"tg-6k2t\">✔: Every message delivered has been previously broadcasted<br>✔: No duplicate delivered messages found<br></td>  </tr>  <br /></table><br />Final Comments<br />**************<br />Congratulations! Your implementation of the 'Best Effort Broadcast' satisfies all properties! <br />A unique token has been generated for your submission right below. Please do not edit. <br /><br />{\"gradingToken\":[45,45,45,45,45,66,69,71,73,78,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10,86,101,114,115,105,111,110,58,32,66,67,80,71,32,118,49,46,53,53,10,10,104,81,73,77,65,57,79,116,77,118,84,69,98,74,49,102,65,81,47,43,74,71,76,82,116,56,113,118,111,105,71,84,49,68,102,111,57,108,108,79,87,90,48,87,120,80,118,78,57,105,118,85,77,117,54,121,89,67,103,80,81,78,89,118,10,98,87,116,79,83,90,108,100,66,89,78,53,84,119,88,111,121,80,73,47,43,76,101,71,114,76,53,90,50,71,90,80,86,112,77,74,113,101,109,72,82,104,87,48,98,98,118,86,86,75,121,57,51,108,120,118,119,88,86,86,90,109,109,55,10,79,54,100,67,53,43,85,106,69,85,110,87,53,106,105,99,109,100,86,47,43,87,71,72,73,120,57,47,47,75,115,47,78,74,113,55,100,48,52,51,69,112,97,50,74,55,67,98,69,103,47,112,89,84,65,106,102,110,54,75,87,80,43,90,10,87,98,121,117,75,107,57,72,113,47,47,101,101,79,116,88,101,43,118,73,106,120,52,88,52,108,83,90,77,83,118,115,84,98,121,113,55,120,53,50,85,75,65,69,71,73,69,104,56,109,71,111,47,79,82,74,68,119,117,74,73,48,118,119,10,52,72,66,113,49,66,56,53,112,55,65,76,65,104,100,114,117,74,102,85,82,57,106,109,103,73,83,113,78,79,68,78,82,74,57,78,86,80,49,90,111,108,80,98,53,109,47,104,78,110,113,118,53,109,81,107,51,106,81,110,118,49,82,51,10,70,101,65,76,121,107,118,110,87,48,82,111,109,120,109,103,49,79,51,77,85,74,79,103,68,119,110,108,52,74,47,49,71,121,120,82,122,110,76,107,102,83,90,116,85,109,103,117,115,81,57,66,107,47,109,49,56,119,106,56,122,81,122,117,10,99,66,66,54,57,121,47,104,47,114,84,75,122,74,47,106,117,113,121,88,47,66,80,89,43,104,120,65,68,75,78,101,89,100,70,65,82,56,47,84,71,47,50,65,100,78,102,67,49,87,43,105,116,116,70,71,88,122,43,110,90,75,113,51,10,82,51,115,114,47,49,101,75,55,87,43,101,57,55,109,87,53,121,53,99,116,52,57,72,117,82,106,80,110,122,52,98,116,100,106,100,73,67,108,74,49,65,80,49,67,68,113,48,89,49,84,102,86,112,119,121,83,80,116,67,109,110,104,83,10,87,47,66,121,57,51,84,97,65,69,102,73,114,109,97,66,50,71,84,52,72,111,109,88,87,77,118,117,86,71,55,74,119,118,106,115,106,97,52,111,102,104,113,50,48,68,55,88,103,84,90,71,65,66,98,51,90,84,69,110,48,70,90,68,10,107,68,121,82,78,107,43,70,47,112,68,70,48,49,85,97,85,102,81,103,74,81,119,49,84,77,52,65,69,80,104,89,120,67,112,70,90,121,55,102,67,72,105,53,97,111,90,47,76,116,102,116,51,100,56,79,113,108,68,67,70,100,122,76,10,72,117,83,77,111,110,49,80,99,76,89,90,122,105,79,71,78,102,52,117,108,67,97,122,113,47,72,87,53,77,112,112,111,85,54,80,116,55,70,98,57,68,102,107,50,118,89,85,98,116,70,66,71,80,108,74,76,112,103,48,47,66,84,83,10,119,65,48,66,77,104,68,81,76,76,108,86,100,48,43,87,47,104,113,109,99,71,115,86,53,54,86,120,68,67,77,90,114,119,68,86,47,51,119,77,119,109,83,98,110,117,109,122,66,118,106,53,107,105,114,74,97,113,69,86,53,82,109,113,10,119,71,104,67,117,119,80,103,57,109,112,101,98,88,67,52,104,111,119,119,109,53,100,120,119,97,75,55,80,69,68,48,118,115,68,114,109,103,113,72,76,109,108,117,116,120,50,115,75,102,99,101,108,78,52,90,112,89,87,116,103,90,110,114,10,114,86,122,117,118,98,65,114,98,108,113,82,79,109,54,115,101,78,116,47,90,113,111,49,90,109,105,86,65,71,119,57,112,50,83,106,55,97,112,88,79,111,113,112,68,89,103,79,106,97,54,98,52,72,118,73,83,112,48,106,112,82,99,66,10,118,47,90,112,105,112,100,87,108,108,117,107,90,109,97,88,108,70,48,122,43,116,80,84,80,52,100,80,113,116,119,102,107,66,97,110,112,66,81,47,54,48,101,49,55,83,83,112,52,121,120,71,119,68,52,48,88,48,85,118,52,56,80,115,10,78,112,110,112,115,86,111,116,71,47,51,119,68,113,53,113,103,107,83,98,10,61,48,115,85,115,10,45,45,45,45,45,69,78,68,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10]}<br />res0: Boolean = true<br />"}]},"apps":[],"jobName":"paragraph_1581275925436_145140684","id":"20160830-154208_1529541172","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T16:06:16+0000","dateFinished":"2020-02-10T16:06:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:311"},{"text":"%md\n\n### Part II: Reliable Broadcast ###\n\nA Reliable Broadcast Abstraction (RB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class ReliableBroadcast extends Port {\n      indication[RB_Deliver];\n      request[RB_Broadcast];\n    }\n    \nAn **RB** component should request `RB_Broadcast` and indicate `RB_Deliver` events, as defined below:\n\n    case class RB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n    case class RB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n       \n\nAs you have already learnt from the course lectures, Reliable Broadcast adds the `Agreement` property into the already existing properties of Best-Effort Broadcast:\n\n1. Validity:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. No duplication: *No message is delivered more than once.*\n3. No creation: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n4. **Agreement**: *If a message m is delivered by some correct process, then m is eventually delivered by every correct process.*\n\nHINT: The recommended algorithm to use in this assignment is *Eager Reliable Broadcast* and is described in page 2 within the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/6c144fd806b3568f6e2c5d7d03e27a29/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/reliablebroadcast.pdf) in the respective lecture.\n\n**Mind that, to complete this part, you will first have to implement and test Best-Effort Broadcast, defined above.**","dateUpdated":"2020-02-09T19:18:45+0000","config":{"editorSetting":{},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Part II: Reliable Broadcast</h3>\n<p>A Reliable Broadcast Abstraction (RB), in Kompics terms, is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class ReliableBroadcast extends Port {\n  indication[RB_Deliver];\n  request[RB_Broadcast];\n}\n</code></pre>\n<p>An <strong>RB</strong> component should request <code>RB_Broadcast</code> and indicate <code>RB_Deliver</code> events, as defined below:</p>\n<pre><code>case class RB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\ncase class RB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Reliable Broadcast adds the <code>Agreement</code> property into the already existing properties of Best-Effort Broadcast:</p>\n<ol>\n  <li>Validity: <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n  <li>No duplication: <em>No message is delivered more than once.</em></li>\n  <li>No creation: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n  <li><strong>Agreement</strong>: <em>If a message m is delivered by some correct process, then m is eventually delivered by every correct process.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Eager Reliable Broadcast</em> and is described in page 2 within the following <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/6c144fd806b3568f6e2c5d7d03e27a29/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/reliablebroadcast.pdf\">document</a> in the respective lecture.</p>\n<p><strong>Mind that, to complete this part, you will first have to implement and test Best-Effort Broadcast, defined above.</strong></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1581275925437_144755935","id":"20160915-152029_348185262","dateCreated":"2020-02-09T19:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:312"},{"text":" \n//Reliable Broadcast\n\nclass EagerReliableBroadcast(init: Init[EagerReliableBroadcast]) extends ComponentDefinition {\n  //EagerReliableBroadcast Subscriptions\n  val beb = requires[BestEffortBroadcast];\n  val rb = provides[ReliableBroadcast];\n \n\n  //EagerReliableBroadcast Component State and Initialization\n  val self = init match {\n    case Init(s: Address) => s\n  };\n  val delivered = collection.mutable.Set[KompicsEvent]();\n \n\n  //EagerReliableBroadcast Event Handlers\n  rb uponEvent {\n    case x@RB_Broadcast(payload) => {\n     \n     /* WRITE YOUR CODE HERE */\n      trigger(BEB_Broadcast(RB_Broadcast(payload)) -> beb)\n     \n    }\n  }\n  \n\n  beb uponEvent {\n    case BEB_Deliver(src, y@RB_Broadcast(payload)) => {\n    \n     /* WRITE YOUR CODE HERE  */\n     if(!delivered.contains(payload)){\n         delivered += payload\n         trigger(RB_Deliver(src,payload)-> rb);\n         trigger(BEB_Broadcast(RB_Broadcast(payload)) -> beb);  \n     } \n     \n    }\n  }\n}","user":"anonymous","dateUpdated":"2020-02-10T16:41:05+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.OutOfMemoryError: GC overhead limit exceeded\n"}]},"apps":[],"jobName":"paragraph_1581275925437_144755935","id":"20160728-150932_1018155040","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T16:41:05+0000","dateFinished":"2020-02-10T16:49:36+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:313"},{"text":"checkRB[BasicBroadcast,EagerReliableBroadcast]();","user":"anonymous","dateUpdated":"2020-02-10T16:41:13+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.OutOfMemoryError: GC overhead limit exceeded\n"}]},"apps":[],"jobName":"paragraph_1581275925437_144755935","id":"20160830-154553_1603284544","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T16:41:13+0000","dateFinished":"2020-02-10T16:49:12+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1581276243938_-396374518","id":"20200209-192403_273314724","dateCreated":"2020-02-09T19:24:03+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"text":"%md\n\n### Part III: Causal-Order Reliable Broadcast ###\n\nA Causal-Order Reliable Broadcast Abstraction (CRB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class CausalOrderReliableBroadcast extends Port {\n      indication[CRB_Deliver];\n      request[CRB_Broadcast];\n    }\n       \nA **CRB** component should request `CRB_Broadcast` and indicate `CRB_Deliver` events, as defined below:\n\n    case class CRB_Deliver(src: Address, payload: KompicsEvent) extends KompicsEvent;\n    case class CRB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n\n\nAs you have already learnt from the course lectures, Causal-Order Reliable Broadcast adds the `Causal Delivery` property into the already existing properties of Reliable and Best-Effort Broadcast:\n\n1. Validity:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. No duplication: *No message is delivered more than once.*\n3. No creation: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n4. Agreement: *If a message m is delivered by some correct process, then m is eventually delivered by every correct process.*\n5. **Causal delivery**: *For any message m1 that potentially caused a message m2, i.e., m1 → m2, no process delivers m2 unless it has already delivered m1.*\n\nHINT: The recommended algorithm to use in this assignment is *Waiting Causal Broadcast* and is described in page 4 within the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/f11d45d4cb0d9685c723dd00de427b8d/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/causalbroadcast.pdf) in the respective lecture.\n\n**Also mind, that to complete this part, you will first have to implement and test Best-Effort Broadcast and Reliable Broadcast, defined above.**\n\n\n#### Working with Vector Clocks ####\nWe have already provided you a `VectorClock` data structure **(already imported)** to aid you with the algorithm implementation. You can briefly see the supported operations below:\n\n```scala\n    case class VectorClock(var vc: Map[Address, Int]) {\n        def inc(addr: Address) : Unit  //increases the clock corresponding to the address @addr provided\n        def set(addr: Address, value: Int) : Unit //sets the clock of @addr to @value\n        def <=(that: VectorClock): Boolean   //returns true if this vector clock instance is lower or equal to @that\n    }\n    object VectorClock {\n        def empty(topology: scala.Seq[Address]): VectorClock //generates a vector clock that has an initial clock value of 0 for each address in the @topology provided\n        def apply(that: VectorClock): VectorClock //copy constructor of a vector clock. E.g. if vc1 is a vector clock vc2 = VectorClock(vc1) is a copy of vc1\n    }\n```\nIn case you want to check the full implementation of the VectorClock, you can find it in our full published gist [here](https://gist.github.com/senorcarbone/5c960ee27a67ec8b6bd42c33303fdcd2).\n","dateUpdated":"2020-02-09T19:18:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Part III: Causal-Order Reliable Broadcast</h3>\n<p>A Causal-Order Reliable Broadcast Abstraction (CRB), in Kompics terms, is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class CausalOrderReliableBroadcast extends Port {\n  indication[CRB_Deliver];\n  request[CRB_Broadcast];\n}\n</code></pre>\n<p>A <strong>CRB</strong> component should request <code>CRB_Broadcast</code> and indicate <code>CRB_Deliver</code> events, as defined below:</p>\n<pre><code>case class CRB_Deliver(src: Address, payload: KompicsEvent) extends KompicsEvent;\ncase class CRB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Causal-Order Reliable Broadcast adds the <code>Causal Delivery</code> property into the already existing properties of Reliable and Best-Effort Broadcast:</p>\n<ol>\n  <li>Validity: <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n  <li>No duplication: <em>No message is delivered more than once.</em></li>\n  <li>No creation: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n  <li>Agreement: <em>If a message m is delivered by some correct process, then m is eventually delivered by every correct process.</em></li>\n  <li><strong>Causal delivery</strong>: <em>For any message m1 that potentially caused a message m2, i.e., m1 → m2, no process delivers m2 unless it has already delivered m1.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Waiting Causal Broadcast</em> and is described in page 4 within the following <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/f11d45d4cb0d9685c723dd00de427b8d/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/causalbroadcast.pdf\">document</a> in the respective lecture.</p>\n<p><strong>Also mind, that to complete this part, you will first have to implement and test Best-Effort Broadcast and Reliable Broadcast, defined above.</strong></p>\n<h4>Working with Vector Clocks</h4>\n<p>We have already provided you a <code>VectorClock</code> data structure <strong>(already imported)</strong> to aid you with the algorithm implementation. You can briefly see the supported operations below:</p>\n<pre><code class=\"scala\">    case class VectorClock(var vc: Map[Address, Int]) {\n        def inc(addr: Address) : Unit  //increases the clock corresponding to the address @addr provided\n        def set(addr: Address, value: Int) : Unit //sets the clock of @addr to @value\n        def &lt;=(that: VectorClock): Boolean   //returns true if this vector clock instance is lower or equal to @that\n    }\n    object VectorClock {\n        def empty(topology: scala.Seq[Address]): VectorClock //generates a vector clock that has an initial clock value of 0 for each address in the @topology provided\n        def apply(that: VectorClock): VectorClock //copy constructor of a vector clock. E.g. if vc1 is a vector clock vc2 = VectorClock(vc1) is a copy of vc1\n    }\n</code></pre>\n<p>In case you want to check the full implementation of the VectorClock, you can find it in our full published gist <a href=\"https://gist.github.com/senorcarbone/5c960ee27a67ec8b6bd42c33303fdcd2\">here</a>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1581275925438_145910182","id":"20160915-154115_478906095","dateCreated":"2020-02-09T19:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"//Causal Reliable Broadcast\n\ncase class DataMessage(timestamp: VectorClock, payload: KompicsEvent) extends KompicsEvent;\n\nclass WaitingCRB(init: Init[WaitingCRB]) extends ComponentDefinition {\n\n  //WaitingCRB Subscriptions\n  val rb = requires[ReliableBroadcast];\n  val crb = provides[CausalOrderReliableBroadcast];\n\n  //WaitingCRB Component State and Initialization\n  val (self, vec) = init match {\n    case Init(s: Address, t: Set[Address]@unchecked) => (s, VectorClock.empty(t.toSeq))\n  };\n\n  //  val V = VectorClock.empty(init match { case Init(_, t: Set[Address]) => t.toSeq })\n  var pending: ListBuffer[(Address, DataMessage)] = ListBuffer();\n  var lsn = 0;\n\n\n  //WaitingCRB Event Handlers\n  crb uponEvent {\n    case x: CRB_Broadcast => {\n     \n     /* WRITE YOUR CODE HERE  */\n     val w = VectorClock.apply(vec);\n        w.set(self, lsn);\n        lsn = lsn + 1;\n        trigger(RB_Broadcast(DataMessage(w, x.payload)) -> rb);\n    }\n  }\n\n  rb uponEvent {\n    case x@RB_Deliver(src: Address, msg: DataMessage) => {\n     \n     /* WRITE YOUR CODE HERE  */\n     pending += ((src, msg));\n    for (it@(address, message) <- pending.sortWith(_._2.timestamp <= _._2.timestamp)) {\n        if (message.timestamp <= vec) {\n            pending -= it;\n            vec.inc(address);\n            trigger(CRB_Deliver(address, message.payload) -> crb);\n        }\n    }\n     \n    }\n  }\n}","dateUpdated":"2020-02-10T17:11:11+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"defined class DataMessage<br />defined class WaitingCRB<br />"}]},"apps":[],"jobName":"paragraph_1581275925438_145910182","id":"20160728-150719_1155234225","dateCreated":"2020-02-09T19:18:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317","user":"anonymous","dateFinished":"2020-02-10T17:11:13+0000","dateStarted":"2020-02-10T17:11:11+0000"},{"text":"checkCRB[BasicBroadcast, EagerReliableBroadcast, WaitingCRB]();","user":"anonymous","dateUpdated":"2020-02-10T17:11:15+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<br />Your submission has been locally simulated and validated.<br /><br /><a href=\"\\static\\log.txt\" target=\"_blank\">Click Here</a> to view the output of the simulation.<br /><style type=\"text/css\">.tg  {border-collapse:collapse;border-spacing:0;border-color:#aabcfe;}.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#669;background-color:#e8edff;}.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#039;background-color:#b9c9fe;}.tg .tg-mb3i{background-color:#D2E4FC;text-align:right;vertical-align:top}.tg .tg-lqy6{text-align:right;vertical-align:top}.tg .tg-vlnx{background-color:#3071a9;color:#ffffff;text-align:center;vertical-align:top}.tg .tg-6k2t{background-color:#D2E4FC;vertical-align:top}.tg tg-6k2l{background-color:#ffb3b3;vertical-align:top}.tg .tg-yw4l{vertical-align:top}</style><table class=\"tg\">  <tr>    <th class=\"tg-vlnx\" colspan=\"3\">Correction Results</th>  </tr><br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">Validity</td> <td class=\"tg-6k2t\">✔:  Eventually every correct process delivers every message broadcasted by correct processes<br></td>  </tr>  <br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">No Duplication-No Creation</td> <td class=\"tg-6k2t\">✔: Every message delivered has been previously broadcasted<br>✔: No duplicate delivered messages found<br></td>  </tr>  <br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">Agreement</td> <td class=\"tg-6k2t\">✔: Every message delivered by a correct process is eventually delivered by every other correct process<br></td>  </tr>  <br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">Causal Delivery</td> <td class=\"tg-6k2t\">✔: All messages delivered respect causality order<br></td>  </tr>  <br /></table><br />Final Comments<br />**************<br />Congratulations! Your implementation of the 'Causal Order Reliable Broadcast' satisfies all properties! <br />A unique token has been generated for your submission right below. Please do not edit. <br /><br />{\"gradingToken\":[45,45,45,45,45,66,69,71,73,78,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10,86,101,114,115,105,111,110,58,32,66,67,80,71,32,118,49,46,53,53,10,10,104,81,73,77,65,57,79,116,77,118,84,69,98,74,49,102,65,81,47,47,100,69,122,74,100,108,116,72,69,81,51,65,102,78,68,66,121,55,100,57,105,119,70,98,119,119,55,85,88,85,89,86,68,106,78,51,100,57,97,65,89,56,112,83,10,67,118,117,90,76,98,54,111,77,99,54,74,102,115,71,71,47,80,108,107,69,98,75,76,50,103,90,73,80,76,55,102,99,53,105,101,69,78,50,119,119,67,53,55,77,73,71,102,114,107,120,53,49,71,54,69,48,113,110,57,47,76,57,49,10,74,116,70,53,86,106,49,101,120,109,108,90,77,97,47,114,76,119,119,67,104,54,122,72,122,77,86,105,65,56,83,112,89,54,106,49,54,116,57,54,90,90,87,78,72,90,67,111,117,67,66,97,111,74,77,90,78,115,66,78,101,108,66,75,10,103,86,53,70,78,85,98,115,78,54,101,70,81,118,74,107,57,117,120,52,119,109,104,66,100,88,107,100,75,104,90,88,50,78,57,76,49,43,105,57,111,104,81,49,90,100,112,57,56,79,50,43,54,112,68,88,122,74,118,89,121,82,57,65,10,90,81,87,106,119,70,50,121,85,120,101,53,107,112,74,53,72,82,70,112,102,100,74,71,119,88,106,55,54,66,85,54,71,68,49,114,73,115,116,101,53,86,79,73,73,99,86,79,120,108,85,54,103,81,43,82,66,67,118,106,111,117,108,47,10,68,89,50,105,53,86,117,56,114,70,86,121,97,97,122,76,100,88,108,48,55,53,54,86,116,47,108,80,110,115,43,109,53,104,74,120,51,97,114,102,87,114,82,70,103,115,53,78,56,117,120,54,108,109,47,105,51,115,98,79,122,51,65,50,10,106,53,118,98,110,55,118,54,107,111,77,52,103,77,118,106,82,121,120,82,43,118,112,88,114,49,68,52,65,103,85,69,56,84,86,77,50,118,107,97,47,102,68,114,76,49,101,47,90,119,122,67,56,43,113,88,81,84,77,99,121,114,71,98,10,107,104,43,97,90,115,43,78,97,111,98,86,99,81,118,122,89,85,73,55,75,88,79,71,81,52,120,105,52,66,104,72,71,50,112,119,104,82,122,122,66,72,49,113,78,111,106,65,107,119,103,75,74,48,49,69,74,113,87,102,121,113,90,85,10,50,50,112,97,54,55,115,54,78,65,79,104,104,71,102,112,71,84,54,78,77,52,97,50,84,70,67,48,43,117,55,73,103,105,120,115,65,49,47,77,67,105,81,117,116,50,68,65,72,105,98,86,89,53,81,52,80,70,109,66,67,86,53,75,10,51,57,99,82,80,121,79,99,104,108,117,86,115,71,103,53,76,73,51,50,119,102,83,119,78,105,100,89,115,79,73,73,104,80,105,43,107,108,74,105,78,120,110,74,99,90,104,110,80,85,65,54,70,65,119,68,103,67,89,97,51,98,104,50,10,53,110,66,114,119,74,82,115,69,106,66,77,118,78,85,111,120,109,70,82,54,69,116,78,70,98,86,82,48,116,81,86,76,122,72,122,76,108,117,100,85,50,85,120,49,80,70,103,80,65,102,101,107,116,122,56,101,102,51,85,78,56,110,83,10,119,70,52,66,100,97,115,68,68,68,71,118,73,117,112,68,99,71,88,98,87,69,81,71,67,70,70,113,101,67,65,103,106,110,98,115,119,57,122,106,120,107,113,52,53,101,101,113,73,104,85,57,81,53,78,98,73,72,67,51,48,77,109,55,10,114,116,90,99,115,73,98,73,74,88,85,77,102,68,78,119,86,114,70,80,49,72,88,105,112,87,88,98,71,52,97,111,71,56,102,106,89,87,81,90,102,78,120,72,74,115,52,84,76,105,69,85,72,69,120,117,73,70,47,97,52,89,83,73,10,47,73,75,52,50,52,79,106,117,88,115,102,106,101,115,97,52,99,80,121,85,57,80,71,57,117,49,74,79,53,54,82,86,116,114,83,112,108,89,86,84,70,114,88,55,48,51,65,43,83,49,104,88,114,47,98,86,80,51,52,73,106,102,49,10,79,105,112,49,47,99,87,56,108,108,48,101,107,114,54,122,73,85,49,120,102,65,78,43,112,56,98,78,49,69,104,88,43,82,88,85,57,48,115,115,76,53,109,107,101,97,80,105,106,112,119,105,85,103,107,119,83,87,80,106,43,113,72,105,10,109,80,70,103,72,90,120,105,112,101,82,118,65,106,52,87,67,101,113,112,87,49,67,111,107,54,70,120,49,120,113,98,70,69,54,111,51,76,74,100,55,114,114,53,72,70,80,56,116,105,87,85,88,75,101,73,112,71,88,104,120,101,79,50,10,57,76,83,76,73,88,82,53,90,76,68,121,120,65,48,120,103,99,77,71,55,87,54,78,86,107,84,56,121,109,109,112,104,98,87,105,85,66,73,57,100,48,100,100,69,97,68,99,53,70,108,73,78,50,52,117,90,108,76,73,107,78,98,117,10,61,51,109,70,120,10,45,45,45,45,45,69,78,68,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10]}<br />res3: Boolean = true<br />"}]},"apps":[],"jobName":"paragraph_1581275925439_145525433","id":"20160728-150824_64351046","dateCreated":"2020-02-09T19:18:45+0000","dateStarted":"2020-02-10T17:11:15+0000","dateFinished":"2020-02-10T17:11:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:318"},{"dateUpdated":"2020-02-09T19:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1581275925439_145525433","id":"20171030-153216_12031065","dateCreated":"2020-02-09T19:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:319"}],"name":"Exercise: Broadcast Abstractions","id":"2F3JN3GJU","angularObjects":{"2BKQCVH92:shared_process":[],"2CVXXPNWV:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}